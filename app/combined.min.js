/*
 * WeNomYou
 * Project dependencies for the WeNomYou project
 * @author Jay Huang, Daniel Engelhard, Enoch Yip
 * @version 0.0.0
 * License: BSD-2-Clause
 */

"use strict";var app=angular.module("WeNomYou",["ngRoute","ui.bootstrap"]);app.constant("API_URL",{url:"http://localhost",loc:"/api/v1/"}),app.config(function($routeProvider,$locationProvider){$locationProvider.html5Mode(!0),$routeProvider.when("/",{templateUrl:"views/index.html",controller:"HomeCtrl"}).when("/register",{templateUrl:"views/login-register.html",controller:"LoginRegCtrl",title:"Register"}).when("/start",{templateUrl:"views/create-challenge.html",controller:"CreateChallengeCtrl",title:"Challenge Creation"}).when("/continue",{templateUrl:"views/create-challenge.html",controller:"CreateChallengeCtrl",title:"Continue Challenge Creation"}).when("/login",{templateUrl:"views/login-register.html",title:"Login"}).otherwise({redirectTo:"/"})}),app.controller("MainCtrl",function($scope,API_URL){$scope.server=API_URL.url}),app.controller("CreateChallengeCtrl",function($scope,CreateChallengeService){CreateChallengeService.enforceFormProgress(),$scope.campaign||CreateChallengeService.init(),$scope.campaign=CreateChallengeService,$scope.saveData=function(){console.log(CreateChallengeService)}}),app.service("CreateChallengeService",function($location,$rootScope){var Challenge={id:"",status:"",name:"",description:"",nominee:"",goal:"0",start_date:"",duration:"",end_date:"",init:function(){var origVals={};for(var prop in this)this.hasOwnProperty(prop)&&"origVals"!=prop&&(origVals[prop]=this[prop]);this.origVals=origVals},reset:function(){for(var prop in this.origVals)this[prop]=this.origVals[prop]}};return Challenge.enforceFormProgress=function(){function maybeBackToStart(){Challenge.id||"/start"==$rootScope.currentUrl||$location.path("start")}$rootScope.currentUrl=$location.path(),maybeBackToStart(),$rootScope.$on("$locationChangeStart",function(){maybeBackToStart()})},Challenge}),app.controller("HomeCtrl",function($scope){$scope.hi="Hello"}),app.controller("LoginRegCtrl",function(){}),app.service("UserService",function($location,$http,APIRegister,ipCookie,Restangular){function copyObjectProperties(srcObj,destObj){for(var key in srcObj)destObj[key]=srcObj[key]}var User={email:"",first_name:"",last_name:"",auth_token:""};return User.updateUserData=function(data){return data?(copyObjectProperties(data,User),void ipCookie("wenomyou.user",User,{expires:239,expirationUnit:"minutes"})):!1},User.isLoggedIn=function(){return ipCookie("wenomyou.user")?(copyObjectProperties(ipCookie("wenomyou.user"),User),User.auth_token):!1},User.setLoggedIn=function(data){return(data=data||ipCookie("wenomyou.user"))?(copyObjectProperties(data,User),ipCookie("wenomyou.user",data,{expires:239,expirationUnit:"minutes"}),$location.path("/"),!0):!1},User.setLoggedOut=function(){Restangular.one("logout").post().finally(function(){User.email="",User.first_name="",User.last_name="",User.auth_token="",ipCookie.remove("wenomyou.user"),$location.path("/login")})},User});